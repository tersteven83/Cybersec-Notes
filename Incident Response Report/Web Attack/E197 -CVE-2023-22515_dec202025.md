# Incident Response Report: SOC235 - Atlassian Confluence Broken Access Control (CVE-2023-22515)
**Incident:** ID,SOC235 / EventID 197, **Date of Report:** "Dec 20, 2025", 
**Analyst:** Steven Razanajatovo, **Severity:** High,
**Status:** Open (Immediate Action Required), **Verdict:** True Positive

## Executive summary
On November 09, 2023, at 09:47 AM, the SOC detected an exploitation attempt against the **Confluence Data Center** (172[.]16.17.234) involving CVE-2023-22515.

Investigation confirmed that an external attacker (43[.]130.1.222) successfully exploited a critical broken access control vulnerability. The attacker sent a specific HTTP GET request to reset the server's setup configuration, followed by HTTP POST requests to create a new unauthorized administrator account. The traffic was allowed by the device, and the activity indicates a full compromise of the application. Immediate containment and incident escalation are required.

## Incident overview
- **Alert Rule**: SOC235 - Atlassian Confluence Broken Access Control 0-Day CVE-2023-22515

- **Event Time**: Nov 09, 2023, 09:47 AM

- **Target Host**: Confluence Data Center (172[.]16.17.234)

- **Attacker IP**: 43[.]130.1.222

- **Device Action**: Allowed

## Investigation timeline & analysis
### Initial exploitation (reset configuration)
The alert was triggered by an HTTP GET request containing a known exploit signature for CVE-2023-22515.

- **Exploit URL**: /_/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false

- **Impact**: This parameter forces the Confluence application to revert its status to "Setup Incomplete," allowing an unauthenticated attacker to access the setup wizard.

- **User-Agent**: curl/7.88.1 (Indicates the use of a command-line tool/script rather than a browser).

### Post-exploitation (Admin creation)
Further log analysis revealed that the attacker proceeded to complete the setup wizard to establish persistence.

- **Action**: Two HTTP POST requests were observed following the initial exploit:

  1. /setup/setupadministrator.action

  2. /setup/finishsetup.action

- **Significance**: These actions confirm the attacker successfully created a new administrator account on the Confluence server.

### Source analysis
- **IP Address**: 43[.]130.1.222

- **Network Owner**: Tencent Building (AS 132203), US/China network block.

- **Reputation**: Flagged as malicious by 2/95 vendors on VirusTotal.

- **Traffic Direction**: Internet to Company Network.

### Internal verification
- **Authorization Check**: The primary user is letsdefend, and no emails or change requests authorized this configuration change.

- **Host Status**: The host is running Windows Server 2019.

## Indicators of Compromise (IoCs)
The following indicators confirm the attack and should be used for scoping.
|  Type | Value  |
|---|---|
| Attacker IP  | 43[.]130.1.222  |
| URL Parameter  |  bootstrapStatusProvider.applicationConfig.setupComplete=false |
| URL  | /setup/setupadministrator.action  |
| User-Agent  |  curl/7.88.1 |

## Containment & remediation
- **Isolation**: The Confluence Data Center (172[.]16.17.234) must be immediately disconnected from the internet and the internal network.

- **Account Audit**: Review the confluence-users group. Identify and delete the rogue administrator account created during the /setup/setupadministrator.action phase.

- **Forensics**: Check the atlassian-confluence.log for the exact username created by the attacker.

- **Blocking**: Block IP 43[.]130.1.222 at the firewall.

## Recommendations
1. **Patch Immediately**: Update the Atlassian Confluence instance to a fixed version (e.g., 8.3.3, 8.4.3, 8.5.2 or later) that addresses CVE-2023-22515.

- **Access Control**: Restrict access to the /setup/* endpoints to known internal management IPs only, using a reverse proxy or WAF.

- **Network Segmentation**: Ensure the Confluence server is not directly exposed to the internet unless necessary, and place it behind a VPN or WAF.