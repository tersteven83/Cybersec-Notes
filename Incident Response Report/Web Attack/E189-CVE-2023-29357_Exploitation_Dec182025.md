# Incident Response Report: SOC227 - SharePoint Server Elevation of Privilege (CVE-2023-29357)
**Date:** Dec 18, 2025, **Analyst:** Steven Razanajatovo, **Platform:** LetsDefend (Simulation), **Incident ID:** SOC227 / EventID 189, **Severity:** High

## Executive summary
On October 06, 2023, the SOC received an alert (SOC227) indicating a potential exploitation of CVE-2023-29357 (Elevation of Privilege) on the **MS-SharePointServer** (172[.]16.17.233).

Investigation confirmed that an external attacker successfully executed an exploit script against the server. The attacker utilized a Python-based tool to bypass authentication and access sensitive API endpoints (/_api/web/siteusers). Although no immediate shell process execution was observed, the web logs confirm the server responded successfully to the exploit requests. The incident is classified as a True Positive Web Attack requiring immediate containment.

## Incident overview
- **Alert Rule**: SOC227 - Microsoft SharePoint Server Elevation of Privilege - Possible CVE-2023-29357 Exploitation

- **Event Time**: Oct 06, 2023, 08:05 PM

- **Target Host**: MS-SharePointServer (172.16.17[.]233)

- **Attacker IP**: 39[.]91.166.222

- **Device Action**: Allowed

## Investigation timeline & analysis
### Initial detection & reputation check
The alert was triggered by an HTTP GET request to **/_api/web/siteusers** originating from IP 39[.]91.166.222.

- **User-Agent Analysis**: The request used the User-Agent **python-requests/2.28.1**, indicating an automated script rather than a standard browser.

- **IP Reputation**: The source IP 39[.]91.166.222 (located in China) was flagged as malicious by 2/95 vendors on VirusTotal.

### Web log analysis (Confirmation of exploit)
Filtering the logs for the specific User-Agent and destination revealed the attacker made three distinct requests during the attack window:

1. **Request 1**: URL /_api/web/siteusers/web/siteusers returned a 404 (Not Found).

2. **Request 2**: URL /_api/web/currentuser returned 200 (OK).

3. **Request 3**: URL /_api/web/siteusers returned 200 (OK).

**Exploit verification:** Research identified a Proof of Concept (PoC) script on GitHub for CVE-2023-29357 that utilizes these exact URL patterns. The successful 200 OK responses confirm the server accepted the requests, indicating the authentication bypass was successful.

### Endpoint & internal analysis
- **Process Execution**: A review of process logs around the event time did not show immediate suspicious process creation (e.g., shell spawning).

- **Network Activity**: No outbound traffic from the SharePoint server back to the malicious IP was observed.

- **Authorized Activity Check**: The "SPAdmin" user was last logged on Oct 07, 2023 (after the event), and no internal emails or scheduled change requests were found to explain the activity. This confirms the activity was unauthorized.

## Indicators of Compromise (IoCs)
The following artifacts identify the attacker and the specific exploit tool used.

| Type  | Value  | Context  |
|---|---|---|
| Attacker IP  |  39.91.166[.]222 | Source of exploit  |
| User-Agent  | python-requests/2.28.1  |  Exploit Script User-Agent |
| Target URL  | /_api/web/siteusers  | targeted API endpoint  |
| Target URL  | /_api/web/currentuser  |  targeted API endpoint |

## Containment & remediation
- **Immediate Containment**: The SharePoint Server 172[.]16.17.233 requires isolation to prevent lateral movement, as the attacker successfully bypassed authentication.

- **Blocking**: Block the IP 39[.]91.166.222 at the perimeter firewall.

- **User Audit**: Force a password reset for the SharePoint administrator accounts and audit the /_api/web/siteusers list to ensure no rogue accounts were created.

## Recommendations
1. **Patch Management**: Apply the official Microsoft security update for CVE-2023-29357 immediately.

2. **WAF Configuration**: Update Web Application Firewall rules to detect and block requests containing the specific User-Agent python-requests or abnormal access to /_api/web/ endpoints from external IPs.

3. **Vulnerability Scanning**: Run a full vulnerability scan on the SharePoint environment to identify if chained vulnerabilities (often used with this CVE) are present.