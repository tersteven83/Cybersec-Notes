# Incident Response Report: SOC153 - Suspicious PowerShell Script Executed
**Incident:** SOC153 / EventID 238, **Date of Report:** "Dec 23, 2025", 
**Analyst:** Steven Razanajatovo, **Severity:** Critical,
**Status:** Open (Active process), **Verdict:** True Positive

## Executive summary
On March 14, 2024, at 05:23 PM, the SOC detected the execution of a suspicious PowerShell script (`payload_1.ps1`) on the endpoint "**Tony**" (172[.]16.17.206).

Investigation confirmed that the user downloaded a malicious script from an external URL and executed it manually. The script successfully bypassed the execution policy and launched. Log analysis indicates the malicious process is **still running** on the endpoint. Immediate isolation of the host is required to prevent further C2 communication or lateral movement.

## Incident overview
- **Alert Rule**: SOC153 - Suspicious Powershell Script Executed

- **Event Time**: Mar 14, 2024, 05:23 PM

- **Hostname**: Tony

- **IP Address**: 172[.]16.17.206

- **File Name**: `payload_1.ps1`

- **Trigger Reason**: Suspicious file detected on system

## Investigation Timeline & Analysis
### Delivery & download
Log management revealed the user actively downloaded the payload via Google Chrome shortly after logging in.

- **05:20 PM**: User "Letsdefend" logged into the host.

- **05:22 PM**: A file named `payload_1.ps1` was downloaded from `https[://]files-ld.s3.us-east-2.amazonaws[.]com/payload_1.ps1`.

- **Network Status**: The traffic for this download was Allowed.

### Execution
One minute after the download, the user executed the script.

- **05:23 PM**: PowerShell execution was triggered.

- **Command Line:**
```
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" "-Command" "if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\LetsDefend\Downloads\payload_1.ps1\payload_1.ps1'"
```
- Technique: The command specifically used `Set-ExecutionPolicy -Scope Process Bypass` to evade the system's default script restrictions.

### Malware analysis
- **File Hash (SHA256):** `db8be06ba6d2d3595dd0c86654a48cfc4c0c5408fdd3f4e1eaf342ac7a2479d0`

- **File Hash (MD5):** `e971b4ed257b0c60287e63c5d533eace`

- **Reputation**: VirusTotal analysis flagged the file as malicious (31/64 vendors), categorizing it as a PowerShell Trojan.

- **C2 Connection**: The malware is associated with the C2 IP `3[.]5.130.147`.

- **Current Status**: The malicious process is currently active/running on the machine.

## Indicators of Compromise (IoCs)
The following artifacts were identified and should be added to blocklists immediately.
| Type  | Value  |
|---|---|
| File Hash (SHA256)  | `db8be06ba6d2d3595dd0c86654a48cfc4c0c5408fdd3f4e1eaf342ac7a2479d0`  |
| URL  |  `https[://]files-ld.s3.us-east-2.amazonaws[.]com/payload_1.ps1` |
| C2 IP  |  `3.5.130[.]147` |
| Filename  | `payload_1.ps1`  |

## Containment & Remediaion
- **Immediate Isolation**: Isolate host `Tony` (172[.]16.17.206) from the network immediately, as the process is currently active.

- **Process Termination**: Kill the active PowerShell process associated with the malicious command line.

- **File Removal**: Delete `payload_1.ps1` from `C:\Users\LetsDefend\Downloads\`.

- **Blocking**: Block the C2 IP `3[.]5.130.147` at the firewall level.

## Recommendations
1. **Scripting Policy**: Enforce stricter PowerShell execution policies (e.g., <mark>Restricted</mark> or <mark>AllSigned</mark>) via Group Policy and monitor for "Bypass" attempts.

2. **Web Filtering**: Block uncategorized file downloads from public cloud storage (like AWS S3 buckets) unless explicitly allow-listed.

3. **User Training**: Investigate why the user manually downloaded and executed the script. If this was a phishing simulation failure or social engineering, enroll the user in targeted security awareness training.


